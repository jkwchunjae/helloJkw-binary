@inherits Nancy.ViewEngines.Razor.NancyRazorViewBase<dynamic>
@{
}

<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Word-Blank</title>
	@*<link rel="stylesheet" type="text/css" href="/Static/js/webix/webix.css" />*@
	<link rel="stylesheet" type="text/css" href="/Static/js/semantic-ui/semantic.css" />

	@*<link rel="stylesheet" type="text/css" href="/Static/js/semantic-ui/components/accordion.css" />*@
	@*<link rel="stylesheet" type="text/css" href="/Static/js/semantic-ui/components/ad.css" />*@
	<link rel="stylesheet" type="text/css" href="/Static/js/semantic-ui/components/breadcrumb.css" />
	<link rel="stylesheet" type="text/css" href="/Static/js/semantic-ui/components/button.css" />
	<link rel="stylesheet" type="text/css" href="/Static/js/semantic-ui/components/card.css" />
	@*<link rel="stylesheet" type="text/css" href="/Static/js/semantic-ui/components/checkbox.css" />*@
	@*<link rel="stylesheet" type="text/css" href="/Static/js/semantic-ui/components/comment.css" />*@
	@*<link rel="stylesheet" type="text/css" href="/Static/js/semantic-ui/components/container.css" />*@
	@*<link rel="stylesheet" type="text/css" href="/Static/js/semantic-ui/components/dimmer.css" />*@
	@*<link rel="stylesheet" type="text/css" href="/Static/js/semantic-ui/components/divider.css" />*@
	@*<link rel="stylesheet" type="text/css" href="/Static/js/semantic-ui/components/dropdown.css" />*@
	@*<link rel="stylesheet" type="text/css" href="/Static/js/semantic-ui/components/embed.css" />*@
	@*<link rel="stylesheet" type="text/css" href="/Static/js/semantic-ui/components/feed.css" />*@
	@*<link rel="stylesheet" type="text/css" href="/Static/js/semantic-ui/components/flag.css" />*@
	@*<link rel="stylesheet" type="text/css" href="/Static/js/semantic-ui/components/form.css" />*@
	@*<link rel="stylesheet" type="text/css" href="/Static/js/semantic-ui/components/grid.css" />*@
	@*<link rel="stylesheet" type="text/css" href="/Static/js/semantic-ui/components/header.css" />*@
	@*<link rel="stylesheet" type="text/css" href="/Static/js/semantic-ui/components/icon.css" />*@
	@*<link rel="stylesheet" type="text/css" href="/Static/js/semantic-ui/components/image.css" />*@
	<link rel="stylesheet" type="text/css" href="/Static/js/semantic-ui/components/input.css" />
	<link rel="stylesheet" type="text/css" href="/Static/js/semantic-ui/components/item.css" />
	<link rel="stylesheet" type="text/css" href="/Static/js/semantic-ui/components/label.css" />
	<link rel="stylesheet" type="text/css" href="/Static/js/semantic-ui/components/list.css" />
	@*<link rel="stylesheet" type="text/css" href="/Static/js/semantic-ui/components/loader.css" />*@
	<link rel="stylesheet" type="text/css" href="/Static/js/semantic-ui/components/menu.css" />
	<link rel="stylesheet" type="text/css" href="/Static/js/semantic-ui/components/message.css" />
	@*<link rel="stylesheet" type="text/css" href="/Static/js/semantic-ui/components/modal.css" />*@
	@*<link rel="stylesheet" type="text/css" href="/Static/js/semantic-ui/components/nag.css" />*@
	@*<link rel="stylesheet" type="text/css" href="/Static/js/semantic-ui/components/popup.css" />*@
	<link rel="stylesheet" type="text/css" href="/Static/js/semantic-ui/components/progress.css" />
	@*<link rel="stylesheet" type="text/css" href="/Static/js/semantic-ui/components/rail.css" />*@
	@*<link rel="stylesheet" type="text/css" href="/Static/js/semantic-ui/components/rating.css" />*@
	@*<link rel="stylesheet" type="text/css" href="/Static/js/semantic-ui/components/reset.css" />*@
	@*<link rel="stylesheet" type="text/css" href="/Static/js/semantic-ui/components/reveal.css" />*@
	@*<link rel="stylesheet" type="text/css" href="/Static/js/semantic-ui/components/search.css" />*@
	@*<link rel="stylesheet" type="text/css" href="/Static/js/semantic-ui/components/segment.css" />*@
	@*<link rel="stylesheet" type="text/css" href="/Static/js/semantic-ui/components/shape.css" />*@
	@*<link rel="stylesheet" type="text/css" href="/Static/js/semantic-ui/components/sidebar.css" />*@
	@*<link rel="stylesheet" type="text/css" href="/Static/js/semantic-ui/components/site.css" />*@
	@*<link rel="stylesheet" type="text/css" href="/Static/js/semantic-ui/components/statistic.css" />*@
	@*<link rel="stylesheet" type="text/css" href="/Static/js/semantic-ui/components/step.css" />*@
	@*<link rel="stylesheet" type="text/css" href="/Static/js/semantic-ui/components/sticky.css" />*@
	@*<link rel="stylesheet" type="text/css" href="/Static/js/semantic-ui/components/tab.css" />*@
	<link rel="stylesheet" type="text/css" href="/Static/js/semantic-ui/components/table.css" />
	@*<link rel="stylesheet" type="text/css" href="/Static/js/semantic-ui/components/transition.css" />*@
	@*<link rel="stylesheet" type="text/css" href="/Static/js/semantic-ui/components/video.css" />*@

	<script src="/Static/js/angular.min.js"></script>
	@*<script src="/Static/js/webix/webix.js"></script>*@

	<style type="text/css">
		div.split-str {
			display: inline-block;
			margin-right: 10px;
		}
	</style>

	<link rel="stylesheet" type="text/css" href="/Static/projects/word-blank/word-blank-common.css"/>
	@if (Model.Type == "study")
	{
		<link rel="stylesheet" type="text/css" href="/Static/projects/word-blank/word-blank-study.css"/>
	}
	else
	{
		<link rel="stylesheet" type="text/css" href="/Static/projects/word-blank/word-blank-exam.css"/>
	}
</head>
<body ng-app="app-wb" ng-controller="wb-controller">
	<div class="ui huge breadcrumb" id="div-mode">
		<a class="section" href="/wb/study/@Model.PathList">빈칸만들기</a>
		<div class="divider">/</div>
		<a class="section" href="/wb/exam/@Model.PathList">시험보기</a>
	</div>

	<div class="ui huge breadcrumb" id="div-navi">
		<div style="display: inline;">
			<a class="section" href="/wb/@Model.Type">Home</a>
		</div>
		<div ng-repeat="path in PathList" style="display: inline;">
			<i class="right chevron icon divider"></i>
			<a class="section" href="/wb/@Model.Type/{{path.PathPath}}">{{path.PathName}}</a>
		</div>
	</div>

	<div class="ui action input" id="div-editor">
		<input type="email" id="editor-email" placeholder="Editor 추가 (email)"/>
		<button class="ui button" ng-click="AddEditor()">추가</button>
		<button class="ui button" ng-click="RemoveEditor()">제거</button>
	</div>

	<div class="ui huge list" id="div-next-list">
		<div class="item" ng-repeat="nextPath in NextPathList">
			<i class="user icon"></i>
			<div class="content">
				<a href="/wb/@Model.Type/@Model.PathList {{nextPath}}">{{nextPath}}</a>
			</div>
		</div>
	</div>

	<div class="ui cards">
		<div class="card study-card page-break-avoid" ng-repeat="text in TextList" style="display: block;">
			<div class="content">
				<div class="header">
					<span ng-repeat="path in text.Path" style="margin-right: 5px;">{{path}}</span>
				</div>
				<div class="content">
					<div class="split-str" ng-repeat="word in text.Content">
						<div class="{{str.IsBlank}}" ng-repeat="str in word.SplitStr">
							<a class="split-str {{str.IsBlank}}" data-name="{{text.Name}}" data-index="{{word.Index}}" data-length="{{str.Length}}">{{str.Str}}</a>
						</div>
					</div>
				</div>
			</div>
			@*<div class="page-break"></div>*@
		</div>
	</div>

	<script src="/Static/js/jquery-2.1.3.min.js"></script>
	<script type="text/javascript">
		var pathList = '@Model.PathList'

		var app = angular.module('app-wb', []);
		var getScope = function () {
			return angular.element(document.querySelector('[ng-controller="wb-controller"]')).scope();
		};
		app.controller('wb-controller', function ($scope) {
			$scope.PathList = new Array();

			$scope.AddEditor = function () {
				var editor = $('#editor-email').val()
				$.post('/wb/add-editor', {
					pathList: JSON.stringify(pathList),
					editor: editor
				}, function (data) {
					loadTextList(pathList)
				})
			}

			$scope.RemoveEditor = function () {
				var editor = $('#editor-email').val()
				$.post('/wb/remove-editor', {
					pathList: JSON.stringify(pathList),
					editor: editor
				}, function (data) {
					loadTextList(pathList)
				})
			}
		});

		function loadTextList(pathList) {
			$.post('/wb/load',
				{
					data: JSON.stringify(pathList),
					take: @Model.Take
				}, function (json) {
					//alert(json)
					var obj = JSON.parse(json)
					var scope = getScope()
					scope.PathList = obj.PathList
					scope.NextPathList = obj.NextPathList
					scope.TextList = obj.TextList
					scope.$apply()

					$('a.split-str').each(function () {
						if ($(this).text() != '<br/>')
							return;
						var div = $(this).parent().parent()
						//$(div).insertAfter('<br/>')
						$(div).css('display', 'block').css('height', '3px')
						$(this).text('')
					})
				})
		}

		$(document).ready(function () {
			loadTextList(pathList)
		})
	</script>

	@if (Model.Type == "study")
	{
		<script src="/Static/projects/word-blank/word-blank-study.js"></script>
	}
	else
	{
		<script src="/Static/projects/word-blank/word-blank-exam.js"></script>
	}

	<script src="/Static/js/semantic-ui/semantic.js"></script>
</body>
</html>